---

title: Primitives

keywords: fastai
sidebar: home_sidebar

summary: "Implementations for vertex, graph, and cell monolayer classes"
description: "Implementations for vertex, graph, and cell monolayer classes"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_primitives.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><h1>Table of Contents<span class="tocSkip"></span></h1></p>
<div class="toc"><ul class="toc-item"><li><span><a href="#Helper-functions-for-Graphs" data-toc-modified-id="Helper-functions-for-Graphs-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Helper functions for Graphs</a></span></li><li><span><a href="#Helper-functions-for-Monolayer" data-toc-modified-id="Helper-functions-for-Monolayer-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Helper functions for Monolayer</a></span></li><li><span><a href="#Graph-primitives" data-toc-modified-id="Graph-primitives-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Graph primitives</a></span></li><li><span><a href="#Cell-monolayer-representations" data-toc-modified-id="Cell-monolayer-representations-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Cell monolayer representations</a></span></li></ul></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Graph primitives:<ul>
<li><a href="/vertex_simulation/primitives#Vertex"><code>Vertex</code></a>: implements a vertex object. Stores position of a given vertex (or vertices) as <code>1x2</code> <code>torch.tensor</code>, and implements methods for interacting with <code>torch</code> autograd. Compatible with D-dimensional <code>NxD</code> <code>torch.tensor</code>.</li>
<li><a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a>: implements graph object. Stores vertices (<a href="/vertex_simulation/primitives#Vertex"><code>Vertex</code></a> object with <code>NxD</code> <code>torch.tensor</code>), edges (<code>Nx2</code> integer array of vertex indices) connecting the vertices, and implements methods for interacting with <code>torch</code> autograd.</li>
</ul>
</li>
<li>Cell monolayer representations: <ul>
<li><a href="/vertex_simulation/primitives#Monolayer"><code>Monolayer</code></a>: Implements cell monolayer, such as (2-dimensional) apical plane of an epithelial tissue. Inherits from <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a> class. [<strong>needs docs</strong>]<ul>
<li><a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a> and <a href="/vertex_simulation/primitives#Monolayer"><code>Monolayer</code></a> have "to", and "device" methods.</li>
</ul>
</li>
</ul>
</li>
<li>to-do:<ul>
<li>extend <a href="/vertex_simulation/primitives#VoronoiRegions2Edges"><code>VoronoiRegions2Edges</code></a> to add out-of-diagram vertices as boundary vertices (or partial cells)</li>
<li>need to add tranfer to GPU and back</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-functions-for-Graphs">Helper functions for Graphs<a class="anchor-link" href="#Helper-functions-for-Graphs"> </a></h2><hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_graph" class="doc_header"><code>plot_graph</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/primitives.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_graph</code>(<strong><code>Xv</code></strong>, <strong><code>edges</code></strong>, <strong><code>plot_arg</code></strong>=<em><code>['g-', 'mo']</code></em>, <strong><code>alphas</code></strong>=<em><code>[0.2, 0.5]</code></em>)</p>
</blockquote>
<p>A function for plotting simple graphs (slow for large graphs)</p>
<ul>
<li><code>Xv</code>: vertex locations</li>
<li><code>edges</code>: graph edges as indices of the vertex pairs that form.
Nx2 array of integers (could be list of lists)</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_graph_as_quiver" class="doc_header"><code>plot_graph_as_quiver</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/primitives.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_graph_as_quiver</code>(<strong><code>g</code></strong>, <strong><code>quiver_kwargs</code></strong>=<em><code>{'units': 'xy', 'angles': 'xy', 'scale_units': 'xy', 'scale': 1.0, 'headwidth': 0, 'headlength': 0, 'width': 0.05, 'color': 'g'}</code></em>, <strong><code>return_Q</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Plot <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a> or <a href="/vertex_simulation/primitives#Monolayer"><code>Monolayer</code></a> object edges.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="graph2networkx_with_pos" class="doc_header"><code>graph2networkx_with_pos</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/primitives.py#L40" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>graph2networkx_with_pos</code>(<strong><code>g</code></strong>)</p>
</blockquote>
<p>Convert <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a> or <a href="/vertex_simulation/primitives#Monolayer"><code>Monolayer</code></a> object toReturn <code>network</code> graph</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-functions-for-Monolayer">Helper functions for Monolayer<a class="anchor-link" href="#Helper-functions-for-Monolayer"> </a></h2><hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_in_edges_" class="doc_header"><code>is_in_edges_</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/primitives.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_in_edges_</code>(<strong><code>e</code></strong>, <strong><code>edge_list</code></strong>)</p>
</blockquote>
<p>Returns edge index in the list, "-" means in reversed order, False if not found.
Used by <a href="/vertex_simulation/primitives#VoronoiRegions2Edges"><code>VoronoiRegions2Edges</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Slowest part of <a href="/vertex_simulation/primitives#VoronoiRegions2Edges"><code>VoronoiRegions2Edges</code></a> is checking whether the edge is in the list of edges, <code>is_in_edges_()</code> function. In <a href="/vertex_simulation/primitives#is_in_edges_"><code>is_in_edges_</code></a> most of the time is spent for the <code>if, elif</code> conditionals (using <code>np</code> binary indexing in <a href="/vertex_simulation/primitives#is_in_edges_"><code>is_in_edges_</code></a> didn't speed up finding regions, actually it slowed it down), need to change how <a href="/vertex_simulation/primitives#VoronoiRegions2Edges"><code>VoronoiRegions2Edges</code></a> works in particular adding edges to list (or need to even avoid it).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="VoronoiRegions2Edges" class="doc_header"><code>VoronoiRegions2Edges</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/primitives.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>VoronoiRegions2Edges</code>(<strong><code>regions</code></strong>)</p>
</blockquote>
<p>Converts Voronoi region vertex indices, like the one obtained from <code>scipy.spatial.Voronoi</code>,
to a list of (<em>undirected</em>) edges (indices of vertex pairs).</p>
<p>Edges [i,j] and [j,i] are considered to be the same edge, and stored as one of these
representations e.g. [j,i], but not both (i.e. no duplicate edges). Note that edge indexing in
<code>cells</code> starts from 1 (not 0!). Thus, when reading cell edges from <code>edge_list</code> you need to
substract 1 from (absolute value of) these indices.</p>
<p>Usage:</p>
<ul>
<li><code>edge_list,cells = VoronoiRegions2Edges(vrn_regions)</code></li>
</ul>
<p>Arg-s:</p>
<ul>
<li><code>regions</code> is a list of lists, empty regions, or regions with out-of-diagram vertices ("-1") are ignored</li>
</ul>
<p>Returns:</p>
<ul>
<li><code>edge_list</code> : list of edges of an undirected graph.</li>
<li><code>cells</code>: dictionary of cells (Voronoi regions), keys: cell numbers, values: list of
<strong>edge indices starting from 1</strong>. Negative indices indicate reversed order for vertices
(together these edges form a closed region--a cell). Use <code>np.sign(cells[c])</code> to find reversed edges.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Graph-primitives">Graph primitives<a class="anchor-link" href="#Graph-primitives"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Vertex" class="doc_header"><code>class</code> <code>Vertex</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/primitives.py#L99" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Vertex</code>(<strong><code>location</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Implements vertex and stores vertex position(s) as Nx2 (or any 2-D tensor) <code>torch.Tensor</code>:(x,y,...)'s.
Rows represent points, columns the spatial dimensions, i.e. <code>[[x1,y1], [x2,y2], ...,[xN,yN]]</code></p>
<ul>
<li>Methods:<ul>
<li><code>dist(self,other)</code> : calculates Euclidean distance between two points (each row).</li>
<li><code>zero_grad_(self)</code> : set all gradients to zero (used during gradient descent at each iter-n step).</li>
<li><code>grad(self)</code> : get gradient w.r.t. each tensor in <code>self.x</code></li>
<li><code>requires_grad_(self,val)</code>: sets <code>torch.tensor</code> flag inplace</li>
<li><code>requires_grad(self)</code>: returns <code>torch.tensor</code> flag</li>
</ul>
</li>
<li>Properties :<ul>
<li><code>x</code> : use it to set/get location torch.tensor (returns or modifies self.x) [<a name="Vertex.x">Vertex.x</a>]</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p>Define vertices with Nx2 (or NxD in general, N:number of vertices, D: number of spatial dimesions) torch tensors:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># initialise and then set vertex location </span>
<span class="n">o</span><span class="o">=</span><span class="n">Vertex</span><span class="p">()</span>
<span class="n">o</span><span class="o">.</span><span class="n">x</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># or with location at init-n</span>
<span class="n">v1</span><span class="o">=</span><span class="n">Vertex</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># you can transfer &quot;v1&quot; and &quot;o&quot; to GPU</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;v1: {v1.device()}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">f</span><span class="s1">&#39;o : {o.device()}&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">():</span>
    <span class="n">v1</span><span class="o">.</span><span class="n">to_</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
    <span class="n">o</span><span class="o">.</span><span class="n">to_</span><span class="p">(</span><span class="n">v1</span><span class="o">.</span><span class="n">device</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;CUDA devices found: {torch.cuda.device_count()}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>
      <span class="n">f</span><span class="s1">&#39;v1: {v1.device()}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">f</span><span class="s1">&#39;o : {o.device()}&#39;</span><span class="p">)</span>

<span class="c1"># calculate distance between vertices</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Distance between two vertices (o &lt;--&gt; v1) : {r.squeeze()}&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>v1: cpu
 o : cpu
CUDA devices found: 4
 v1: cuda:0
 o : cuda:0
Distance between two vertices (o &lt;--&gt; v1) : 1.4142135381698608
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Graph" class="doc_header"><code>class</code> <code>Graph</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/primitives.py#L177" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Graph</code>(<strong><code>vertices</code></strong>=<em><code>None</code></em>, <strong><code>edges</code></strong>=<em><code>None</code></em>, <strong><code>fixed</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Implements graph object. Stores vertices and edges.</p>
<ul>
<li>Methods:<ul>
<li><code>length(self)</code> : calculates (Euclidean) edge lengths for each edge in the graph.</li>
<li><code>direction(self)</code>: calculates edge vectors (<code>second_vertex - first_vertex</code> positions)</li>
<li><code>get_vertex_grad(self)</code>: returns accumulated gradients w.r.t. to vertex positions.</li>
<li><code>set_zero_grad_(self)</code>: sets gradients w.r.t. to vertex positions to zeros.</li>
</ul>
</li>
<li>Properties :<ul>
<li><code>vertices</code> : variable vertices represented by <a href="/vertex_simulation/primitives#Vertex"><code>Vertex</code></a> object (needs autograd).</li>
<li><code>edges</code> : edges connecting vertices.Nx2 array of integers (vertex indices).
Can be any <code>torch.tensor</code> compatible array with <code>tolist()</code> method (doesn't need autograd).</li>
<li><code>fixed</code>: [<strong>not yet implemented</strong>] stores information about constant/fixed vertices (for setting boundary).
Provided for convenience, turn off gradient calculation separately from "variable" vertices to keep them constant.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When initializing <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a> objects provide vertices (as <a href="/vertex_simulation/primitives#Vertex"><code>Vertex</code></a> object) and edges (connected vertex indices) at initialization, or set it later with <code>self.vertices</code> and <code>self.edges</code> property setters.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
          <span class="n">edges</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span> <span class="p">)</span>

<span class="c1"># Plot vertex positions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">detach</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">detach</span><span class="p">()[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">);</span><span class="c1"># this plots all vertices</span>
<span class="c1"># plot directed edges to check them, to calculate direction use `direction()` function in Graph object</span>
<span class="n">quiver_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span><span class="s1">&#39;scale_units&#39;</span><span class="p">:</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;scale&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="s1">&#39;headwidth&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;headlength&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">07</span><span class="p">}</span>
<span class="n">plot_graph_as_quiver</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">quiver_kwargs</span><span class="o">=</span><span class="n">quiver_kwargs</span><span class="p">)</span> <span class="c1">#plot edges with directions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">]);</span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use <code>device()</code> and <code>to_()</code> to check device and move <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a> tensors (vertices and edges) to GPU</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">device</span><span class="p">())</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">():</span>
    <span class="n">g</span><span class="o">.</span><span class="n">to_</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">device</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;vertices&#39;: device(type=&#39;cpu&#39;), &#39;edges&#39;: device(type=&#39;cpu&#39;)}
{&#39;vertices&#39;: device(type=&#39;cuda&#39;, index=0), &#39;edges&#39;: device(type=&#39;cuda&#39;, index=0)}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Evaluating functions that depend on vertex positions (edge Euclidean length, and direction functions are already implemented in <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a> class)</p>
<ul>
<li>Example below illustrates how to compute spatial gradient $\frac{\partial E}{\partial x_i}$ for $E(\{x_i\})=\sum_{edges}l_{ij}^2$ for vertices shown in the graph above. In a more general case, you can use vertex positions using <code>g.vertices.x</code> of a <a href="/vertex_simulation/primitives#Vertex"><code>Vertex</code></a> object, and check gradient tag with <code>g.vertices.requires_grad()</code> and enable gradient tracking inplace with <code>g.vertices.requires_grad_(True)</code>.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># do something with vertex positions</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="c1"># edge lengths</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">l</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># some function that returns a scalar</span>

<span class="c1"># compute gradients w.r.t. variables of E </span>
<span class="n">E</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="c1"># copying grad-s into dEdx as a list</span>
<span class="n">dEdx</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">get_vertex_grad</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># reset gradients to zeros (useful for iterative calculations s.a. gradient descent)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_zero_grad_</span><span class="p">()</span>
<span class="n">dEdx_2</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">get_vertex_grad</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;dEdx=</span><span class="si">{dEdx}</span><span class="se">\n</span><span class="s1">---</span><span class="se">\n</span><span class="s1">after zeroing gradients</span><span class="se">\n</span><span class="s1">dEdx=</span><span class="si">{dEdx_2}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dEdx=[[6.0, 6.0], [0.0, -6.0], [-6.0, 0.0]]
---
after zeroing gradients
dEdx=[[0.0, 0.0], [0.0, 0.0], [0.0, 0.0]]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cell-monolayer-representations">Cell monolayer representations<a class="anchor-link" href="#Cell-monolayer-representations"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Monolayer" class="doc_header"><code>class</code> <code>Monolayer</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/primitives.py#L263" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Monolayer</code>(<strong><code>vertices</code></strong>=<em><code>None</code></em>, <strong><code>edges</code></strong>=<em><code>None</code></em>, <strong><code>cells</code></strong>=<em><code>None</code></em>, <strong><code>fixed</code></strong>=<em><code>None</code></em>) :: <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a></p>
</blockquote>
<p>Implements 2-dimensional cell monolayer (apical plane) represented by vertices and edges.</p>
<p><a href="/vertex_simulation/primitives#Monolayer"><code>Monolayer</code></a> inherits <em>all methods, and properties</em> of <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a></p>
<ul>
<li>Methods:<ul>
<li><code>perimeter(self)</code> : calculates cell perimeters. Returns <code>torch.tensor</code>.</li>
<li><code>area(self)</code> : calculates cell areas (2-d polygons). Returns <code>torch.tensor</code>.
[<a name="Monolayer.area">Monolayer.area</a>]</li>
</ul>
</li>
<li>Properties:<ul>
<li><code>cells</code> : dictionary of lists, with cell numbers (keys) and list of
<strong>edge indices starting from 1</strong> (values). Negative indices indicate reversed order for vertices
(cell is defined as a closed region formed by edges connected end-to-end).
Use <code>np.sign(cells[c])</code> to find reversed edges for cell <code>c</code>.</li>
</ul>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="/vertex_simulation/primitives#Monolayer"><code>Monolayer</code></a> assumes that cells are 2D <em>simple polygons</em>. For a <em>simple polygon</em> with $n$ sides, <a href="/vertex_simulation/primitives#Monolayer.area("><code>Monolayer.area()</code></a>) implements a <em>shoelace formula</em>:
{{% raw %}}
$$A_{polygon} = \frac{1}{2}\left|{\sum^{n-1}_{i=1}x_{i}y_{i+1} + x_ny_1 - \sum^{n-1}_{i=1}x_{i+1}y_{i} - x_1 y_n}\right|$$
{{% endraw %}}
{{% raw %}}
$$ = \frac{1}{2}\left|x_1y_2+x_2y_3+\dots+x_{n-1}y_n +x_ny_1 - x_2y_1-x_3y_2-\dots-x_ny_{n-1}-x_1y_n\right|$$
{{% endraw %}}</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>You can use <a href="/vertex_simulation/primitives#Graph"><code>Graph</code></a> functions <code>to_()</code> and <code>device()</code> to move tensors to GPU and check tensor's device</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># triangle shaped cell:</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">([[</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span><span class="o">-.</span><span class="mi">1</span><span class="p">],[</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mi">9</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="o">-.</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">tri_cells</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Monolayer</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">v</span><span class="p">,</span><span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span><span class="n">cells</span><span class="o">=</span><span class="n">tri_cells</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;m is on :&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">device</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Perimeter=&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">perimeter</span><span class="p">(),</span><span class="s1">&#39;; Area=&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">area</span><span class="p">())</span>

<span class="c1"># plot monolayer graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_graph_as_quiver</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;mo&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>m is on : {&#39;vertices&#39;: device(type=&#39;cpu&#39;), &#39;edges&#39;: device(type=&#39;cpu&#39;)}
Perimeter= tensor([[3.4142]]) ; Area= tensor([0.5000])
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we need to remember to copy tensors to CPU (and detach from the Pytorch's computational graph) to be able to use <code>matplotlib</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now let&#39;s do the same computation on GPU (if available)</span>
<span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">():</span>
    <span class="n">m</span><span class="o">.</span><span class="n">to_</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;m is on :&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">device</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Perimeter=&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">perimeter</span><span class="p">(),</span><span class="s1">&#39;; Area=&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">.</span><span class="n">area</span><span class="p">())</span>

    <span class="c1"># plot monolayer graph</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plot_graph_as_quiver</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">(),</span><span class="n">m</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cpu</span><span class="p">(),</span><span class="s1">&#39;mo&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>m is on : {&#39;vertices&#39;: device(type=&#39;cuda&#39;, index=0), &#39;edges&#39;: device(type=&#39;cuda&#39;, index=0)}
Perimeter= tensor([[3.4142]], device=&#39;cuda:0&#39;) ; Area= tensor([0.5000], device=&#39;cuda:0&#39;)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="k">import</span> <span class="n">Voronoi</span><span class="p">,</span><span class="n">voronoi_plot_2d</span>

<span class="n">v_seeds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mf">5.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mf">5.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">4.</span><span class="p">],</span>
                  <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mf">4.</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mf">4.</span><span class="p">],[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.5</span><span class="p">],</span>
                  <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.5</span><span class="p">],[</span><span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mf">2.5</span><span class="p">],[</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mf">2.5</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mf">1.</span><span class="p">]])</span>

<span class="n">vrn</span> <span class="o">=</span> <span class="n">Voronoi</span><span class="p">(</span><span class="n">v_seeds</span><span class="p">)</span>
<span class="n">edge_list</span><span class="p">,</span><span class="n">hex_cells</span> <span class="o">=</span> <span class="n">VoronoiRegions2Edges</span><span class="p">(</span><span class="n">vrn</span><span class="o">.</span><span class="n">regions</span><span class="p">)</span> <span class="c1"># convert regions to edges and cells</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">verts</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="n">vrn</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">edge_list</span><span class="p">)</span>

<span class="n">cell_graph</span> <span class="o">=</span> <span class="n">Monolayer</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">Vertex</span><span class="p">(</span><span class="n">vrn</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">copy</span><span class="p">()),</span> <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span> <span class="n">cells</span><span class="o">=</span><span class="n">hex_cells</span><span class="p">)</span>
<span class="c1"># cell_graph.vertices.requires_grad_(True) #&lt;-- use for enabling gradient calculations</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Perimeter=&#39;</span><span class="p">,</span><span class="n">cell_graph</span><span class="o">.</span><span class="n">perimeter</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span><span class="s1">&#39;;</span><span class="se">\n</span><span class="s1">Area=&#39;</span><span class="p">,</span><span class="n">cell_graph</span><span class="o">.</span><span class="n">area</span><span class="p">())</span>
<span class="c1"># plot monolayer graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plot_graph_as_quiver</span><span class="p">(</span><span class="n">cell_graph</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cell_graph</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">cell_graph</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;mo&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Perimeter= tensor([6.0000, 6.0000, 6.0000], dtype=torch.float64) ;
Area= tensor([2.5981, 2.5981, 2.5981], dtype=torch.float64)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

