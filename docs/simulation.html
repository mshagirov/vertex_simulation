---

title: Simulation

keywords: fastai
sidebar: home_sidebar

summary: "Tools for  simulating cellular vertex dynamics. Iterative algorithm implementations, cell monolayer generators (vertices). (anything else to add?!)"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_simulation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>numerical integration method(s)<ul>
<li>Euler's method</li>
<li>any other approximation?</li>
</ul>
</li>
<li>implement functions for checking:<ul>
<li>vertex configuration (for high tension cases there might be overlapping, or twisted cells which are considered illigal by the model)</li>
<li>update steps that implement required vertex check, and any other checks needed before accepting vertex position update</li>
</ul>
</li>
<li>implement Voronoi cell generator for different cell configuration cases (random, evenly spaced, concave cell, ...)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Euler's-method">Euler's method<a class="anchor-link" href="#Euler's-method">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># define function for numerical integration</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cell-monolayer-graph-generators">Cell monolayer graph generators<a class="anchor-link" href="#Cell-monolayer-graph-generators">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="unit_hex_seeds" class="doc_header"><code>unit_hex_seeds</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/simulation.py#L10" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>unit_hex_seeds</code>(<strong><code>Sx</code></strong>, <strong><code>Sy</code></strong>)</p>
</blockquote>
<p>Produces seed locations for Voronoi such that Voronoi regions
form rectangle of hexagonal cells with unit side length (==1).</p>
<p>Arg-s:</p>
<ul>
<li><code>Sx</code>, <code>Sy</code>: width (x-axis) and height (y-axis) in cells (assumes that both $S_{x,y}&gt;0$)</li>
</ul>
<p>Returns:</p>
<ul>
<li><code>numpy</code> array with <code>Sx</code>x<code>Sy</code> rows and 2 columns.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mask2vrn_region" class="doc_header"><code>mask2vrn_region</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/simulation.py#L27" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mask2vrn_region</code>(<strong><code>verts</code></strong>, <strong><code>vrn_regions</code></strong>, <strong><code>row_mask</code></strong>)</p>
</blockquote>
<p>Apply mask to Voronoi regions and vertices and re-label them.</p>
<p>In addition to the <code>row_mask</code> (for vertices), also removes empty regions
and regions with "-1" Voronoi vertices.</p>
<p>Arg-s:</p>
<ul>
<li><code>verts</code> : Voronoi vertex locations</li>
<li><code>vrn_regions</code>: Voronoi regions ("cells"). Empty regions and
out-of-diagram Voronoi regions with "-1" vertices are removed.</li>
</ul>
<p>Returns:</p>
<ul>
<li><code>v_x</code> : vertices after applying the mask (<code>=verts[row_mask,:]</code>)</li>
<li><code>regions</code>: re-labelled regions (with updated vertex indices)</li>
</ul>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="unit_hexagons" class="doc_header"><code>unit_hexagons</code><a href="https://github.com/mshagirov/vertex_simulation/tree/master/vertex_simulation/simulation.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>unit_hexagons</code>(<strong><code>Nx</code></strong>, <strong><code>Ny</code></strong>)</p>
</blockquote>
<p>Produces Nx by Ny hexagons with unit length edges.</p>
<p>Uses scipy.spatial.Voronoi, then trims non-hexagon edge cells and vertices.</p>
<p>Returns:</p>
<ul>
<li><code>v_x</code>: vertex locations, Mx2 <code>numpy</code> array (M number of vertices)</li>
<li><code>regions</code>: cell vertices (Voronoi regions; list of lists)</li>
</ul>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">v_x</span><span class="p">,</span><span class="n">regions</span> <span class="o">=</span><span class="n">unit_hexagons</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">edge_list</span><span class="p">,</span><span class="n">cells</span> <span class="o">=</span> <span class="n">VoronoiRegions2Edges</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">v_x</span><span class="p">,</span><span class="n">edge_list</span><span class="p">,</span><span class="n">plot_arg</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="s1">&#39;m.&#39;</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>area:$A_{hex}=\frac{3\sqrt{3}}{2}l_{side}$</p>
<ul>
<li>on CPU (my mac) :<ul>
<li>~9 mins for 2^15 iter-s <strong>5x5</strong> cells</li>
<li>~40 mins for 2^15 iter-s <strong>10x10</strong> cells</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
</div>
 

